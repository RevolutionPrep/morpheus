<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>base.rb</title>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div id="jump_to">
    Jump To &hellip;
    <div id="jump_wrapper">
      <div id="jump_page">
          <a class="source" href="/index.html">Index</a>
          <a class="source" href="../ext/typhoeus.html">typhoeus.rb</a>
          <a class="source" href="../polaris_client/associations.html">associations.rb</a>
          <a class="source" href="../polaris_client/log_subscriber.html">log_subscriber.rb</a>
          <a class="source" href="../polaris_client/railtie.html">railtie.rb</a>
          <a class="source" href="../polaris_resource.html">polaris_resource.rb</a>
          <a class="source" href="associations/association.html">association.rb</a>
          <a class="source" href="associations/belongs_to_association.html">belongs_to_association.rb</a>
          <a class="source" href="associations/has_many_association.html">has_many_association.rb</a>
          <a class="source" href="associations/has_one_association.html">has_one_association.rb</a>
          <a class="source" href="base.html">base.rb</a>
          <a class="source" href="configuration.html">configuration.rb</a>
          <a class="source" href="errors.html">errors.rb</a>
          <a class="source" href="mixins/associations.html">associations.rb</a>
          <a class="source" href="mixins/attributes.html">attributes.rb</a>
          <a class="source" href="mixins/conversion.html">conversion.rb</a>
          <a class="source" href="mixins/finders.html">finders.rb</a>
          <a class="source" href="mixins/introspection.html">introspection.rb</a>
          <a class="source" href="mixins/persistence.html">persistence.rb</a>
          <a class="source" href="mixins/reflections.html">reflections.rb</a>
          <a class="source" href="mixins/request_handling.html">request_handling.rb</a>
          <a class="source" href="mixins/response_parsing.html">response_parsing.rb</a>
          <a class="source" href="mock.html">mock.rb</a>
          <a class="source" href="reflection.html">reflection.rb</a>
          <a class="source" href="relation.html">relation.rb</a>
          <a class="source" href="request.html">request.rb</a>
          <a class="source" href="request_cache.html">request_cache.rb</a>
          <a class="source" href="request_queue.html">request_queue.rb</a>
          <a class="source" href="response.html">response.rb</a>
          <a class="source" href="type_caster.html">type_caster.rb</a>
      </div>
    </div>
  </div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <tr>
      <th class=docs><h1>base.rb</h1></th>
      <th class=code></th>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-1">&#182;</a>
        </div>
        <p>Serving as the superclass to all resources, PolarisResource::Base
should be subclassed and extended from within your application.
The Base class consists of the main components one would need to
use the PolarisResource API. The behavior of the class is contained
in several module &lsquo;mix-ins&rsquo;. Each of these modules will be explained
within itself. Just know that the Base class includes these modules
for you.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre><span class="k">module</span> <span class="nn">PolarisResource</span>
  <span class="k">class</span> <span class="nc">Base</span>
    <span class="kp">extend</span>  <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Naming</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Validations</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Dirty</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializers</span><span class="o">::</span><span class="no">JSON</span>
    <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Serializers</span><span class="o">::</span><span class="no">Xml</span>
    </pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-2">&#182;</a>
        </div>
        <p>These modules wrap distinct behavior that is used within the Base class.
In many cases they rely upon other classes in the library to complete
their functionality. The helper classes can be used stand-alone, but
are most effective when used as collaborators to the mix-in behaviors.</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="kp">include</span> <span class="no">Associations</span>
    <span class="kp">include</span> <span class="no">Attributes</span>
    <span class="kp">include</span> <span class="no">Conversion</span>
    <span class="kp">include</span> <span class="no">Finders</span>
    <span class="kp">include</span> <span class="no">Introspection</span>
    <span class="kp">include</span> <span class="no">Persistence</span>
    <span class="kp">include</span> <span class="no">Reflections</span>
    <span class="kp">include</span> <span class="no">RequestHandling</span>
    <span class="kp">include</span> <span class="no">ResponseParsing</span></pre></div>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-3">&#182;</a>
        </div>
        <p>Defines a default &lsquo;id&rsquo; property on all instances of PolarisResource::Base and subclasses</p>
      </td>
      <td class=code>
        <div class='highlight'><pre>    <span class="n">property</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:integer</span>

    <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">new_attributes</span> <span class="o">=</span> <span class="p">{})</span>
      <span class="n">new_attributes</span> <span class="o">=</span> <span class="no">HashWithIndifferentAccess</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">new_attributes</span><span class="p">)</span>
      <span class="n">new_attributes</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
        <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">default_attributes</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">attribute</span><span class="o">.</span><span class="n">to_sym</span><span class="p">,</span> <span class="kp">nil</span><span class="p">)</span> <span class="k">unless</span> <span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="o">.</span><span class="n">attribute_defined?</span><span class="p">(</span><span class="n">attribute</span><span class="p">)</span>
        <span class="n">update_attribute</span><span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">==</span><span class="p">(</span><span class="n">comparison_object</span><span class="p">)</span>      
      <span class="n">comparison_object</span><span class="o">.</span><span class="n">equal?</span><span class="p">(</span><span class="nb">self</span><span class="p">)</span> <span class="o">||</span>
        <span class="p">(</span><span class="n">comparison_object</span><span class="o">.</span><span class="n">instance_of?</span><span class="p">(</span><span class="nb">self</span><span class="o">.</span><span class="n">class</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="n">comparison_object</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="nb">id</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">comparison_object</span><span class="o">.</span><span class="n">new_record?</span><span class="p">)</span>
    <span class="k">end</span>
    
    <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">base_class</span>
      <span class="nb">self</span>
    <span class="k">end</span>
    
    <span class="kp">private</span>
    
    <span class="k">def</span> <span class="nf">method_missing</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">attributes</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">))</span></pre></div>
      </td>
    </tr>
    <tr id='section-4'>
      <td class=docs>
        <div class="pilwrap">
          <a class="pilcrow" href="#section-4">&#182;</a>
        </div>
        <p>Defines attribute accessors when the missing method can be found in the attributes hash</p>

      </td>
      <td class=code>
        <div class='highlight'><pre>        <span class="n">define_attribute_accessor</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="nb">send</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">block</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="k">super</span>
      <span class="k">end</span>
    <span class="k">end</span>

  <span class="k">end</span>
<span class="k">end</span></pre></div>
      </td>
    </tr>
  </table>
</div>
</body>